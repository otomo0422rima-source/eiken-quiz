<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>è‹±æ¤œ1åˆ†ã‚¯ã‚¤ã‚º</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f2f2f7; /* iOSé¢¨ */
  margin: 0;
  padding: 0;
  }


  h1 {
    font-size: 24px;
    margin-bottom: 20px;
  }

  .card {
  background: #fff;
  margin: 18px;
  padding: 24px;
  border-radius: 20px;
  box-shadow: 0 12px 32px rgba(0,0,0,0.08);
}



  .jp {
    color: #666;
    font-size: 14px;
    margin-bottom: 15px;
  }

  button {
    background: #007aff;

  width: 100%;
  padding: 18px;
  margin-top: 12px;
  font-size: 17px;
  border-radius: 14px;
  border: none;
  font-weight: 400;
}

button:active {
  transform: scale(0.97);
  opacity: 0.9;
}



  .level-btn {
    background: #007aff;
    color: #fff;
  }

  .choice {
  background: #f2f2f7;
  border-radius: 14px;
  transition: 0.2s;
}

.choice:hover {
  background: #e5e5ea;
}


.correct {
  background: linear-gradient(135deg, #34c759, #2ecc71) !important;
  color: white;
}

.wrong {
  background: linear-gradient(135deg, #ff3b30, #ff453a) !important;
  color: white;
}



  .next-btn {
    background: #007aff;
    color: #fff;
    display: none;
  }

  .app-header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  padding: 14px 16px;
  font-size: 18px;
  font-weight: 700;
  border-bottom: 1px solid #e5e5ea;
}


.quiz-header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: #fff;
  padding: 12px 16px;
  display: grid;
  grid-template-columns: 40px 1fr 40px;
  align-items: center;
  border-bottom: 1px solid #eee;
}
#prevBtn {
  font-size: 18px;
}



.icon-btn {
  width: 40px;
  height: 40px;
  border-radius: 12px;
  background: #007aff;
  color: white;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 20px;
  line-height: 1;
  padding: 0;
  border: none;
}



.progress {
  text-align: center;
  font-size: 14px;
  font-weight: 600;
  color: #444;
}

.close-btn {
  font-size: 22px;
}
#question {
  font-size: 22px;
  font-weight: 700;
  margin: 16px 0 8px;
  margin-top: 24px;

}

.choice {
  background: #f9f9fb;
  border-radius: 16px;
  padding: 18px;
  font-size: 17px;
  font-weight: 600;
  box-shadow: 0 4px 12px rgba(0,0,0,0.04);
  border: 1px solid #eee;
}

.choice:hover {
  transform: translateY(-1px);
}


.choice:active {
  transform: scale(0.97);
  box-shadow: 0 2px 6px rgba(0,0,0,0.06);
}

.correct, .wrong {
  color: #fff;
  animation: pop 0.2s ease;
}

@keyframes pop {
  0% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

#result {
  background: #f2f2f7;
  padding: 16px;
  border-radius: 14px;
  margin-top: 16px;
}
#quiz {
  padding-top: calc(24px + env(safe-area-inset-top));
}





  /* ã‚¹ãƒãƒ›ç”¨ */
@media (max-width: 480px) {
  h1 {
    font-size: 22px;
  }

  #question {
    font-size: 20px;
  }

  .choice {
    font-size: 18px;
    padding: 18px;
  }

  #quiz {
    padding-top: 24px;
  }
}
/* ===== ç”»é¢å…¨ä½“ã‚’å°‘ã—ä¸‹ã’ã¦æ“ä½œã—ã‚„ã™ãã™ã‚‹ ===== */

.card {
  margin-top: 24px;
}

@media (max-width: 480px) {
  .card {
    margin-top: 48px;
  }
}
/* ã‚¹ãƒ¯ã‚¤ãƒ—ä¸­ã®èª¤ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢ */
/* Safariã®æˆ»ã‚‹ã‚¹ãƒ¯ã‚¤ãƒ—ã¨ç«¶åˆã—ãªã„ã‚ˆã†ä¸­å¤®ã®ã¿ */
#quiz {
  touch-action: pan-y;
  padding-left: 24px;
  padding-right: 24px;
}


</style>
</head>

<body>
  <header class="app-header">
    ğŸ“˜ è‹±æ¤œã‚¯ã‚¤ã‚º
  </header>
  <div class="card" id="resultCard" style="display:none;">
    <h2>çµæœ</h2>
    <p id="scoreText"></p>
  
    <button onclick="retrySameLevel()">ã‚‚ã†ä¸€åº¦ã“ã®ãƒ¬ãƒ™ãƒ«</button>
    <button onclick="restartQuiz()">ãƒ¬ãƒ™ãƒ«é¸æŠã¸</button>
  </div>
<div class="card" id="level">
  <p>ãƒ¬ãƒ™ãƒ«ã‚’é¸ã‚“ã§ãã ã•ã„</p>
  <button class="level-btn" onclick="startQuiz('5')">è‹±æ¤œ5ç´š</button>
<button class="level-btn" onclick="startQuiz('4')">è‹±æ¤œ4ç´š</button>
<button class="level-btn" onclick="startQuiz('3')">è‹±æ¤œ3ç´š</button>
<button class="level-btn" onclick="startQuiz('æº–2')">è‹±æ¤œæº–2ç´š</button>
<button class="level-btn" onclick="startQuiz('2')">è‹±æ¤œ2ç´š</button>
<button class="level-btn" onclick="startQuiz('1')">è‹±æ¤œ1ç´š</button>
</div>

<div class="card" id="quiz" style="display:none;">

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="quiz-header">
    <button
      id="prevBtn"
      class="icon-btn"
      onclick="prevQuestion()"
      style="visibility:hidden;"
    >
      â†
    </button>
  
    <div class="progress">
      <span id="progressText">1 / 10</span>
    </div>
  
    <button
      class="icon-btn close-btn"
      onclick="backToLevel()"
    >
      âœ•
    </button>
  </div>
  

  <!-- å•é¡Œ -->
  <h2 id="question"></h2>
  <p class="jp" id="jp"></p>

  <!-- é¸æŠè‚¢ -->
  <div id="choices"></div>

  <!-- çµæœ -->
  <div id="result"></div>

  <!-- æ¬¡ã¸ -->
  <button class="next-btn" id="nextBtn" onclick="nextQuestion()">
    æ¬¡ã®å•é¡Œã¸
  </button>

</div>




<script src="quizzes.js"></script>
<script>
let previousScreen = "level";
let currentLevel;
let currentIndex = 0;
let correctCount = 0;

function startQuiz(level) {
  previousScreen = "level"; // â† è¿½åŠ 

  currentLevel = level;
  currentIndex = 0;
  correctCount = 0;

  shuffle(quizzes[currentLevel]);

  document.getElementById("level").style.display = "none";
  document.getElementById("quiz").style.display = "block";
  showQuestion();
}


function showQuestion() {
  document.getElementById("result").innerHTML = "";
  document.getElementById("nextBtn").style.display = "none";
  document.getElementById("prevBtn").style.visibility =
  currentIndex > 0 ? "visible" : "hidden";


  // å‰ã®å•é¡Œãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡


  const quiz = quizzes[currentLevel][currentIndex];
  shuffleChoices(quiz);
  
  // å•é¡Œç•ªå·ã‚’è¡¨ç¤º
  // ãƒ˜ãƒƒãƒ€ãƒ¼ã®é€²æ—è¡¨ç¤º
document.getElementById("progressText").innerText =
  `å•é¡Œ ${currentIndex + 1} / ${quizzes[currentLevel].length}`;

// å•é¡Œæ–‡
document.getElementById("question").innerText = quiz.question;

  
  document.getElementById("jp").innerText = quiz.jp;

  const choicesDiv = document.getElementById("choices");
  choicesDiv.innerHTML = "";

  quiz.choices.forEach((choice, index) => {
    const btn = document.createElement("button");
    btn.innerText = choice;
    btn.className = "choice";
    btn.onclick = () => checkAnswer(btn, index);
    choicesDiv.appendChild(btn);
  });
}



function checkAnswer(button, selected) {
  const quiz = quizzes[currentLevel][currentIndex];
  const buttons = document.querySelectorAll(".choice");
  buttons.forEach(b => b.disabled = true);

  let resultHtml = "";

  if (selected === quiz.answer) {
    button.classList.add("correct");
    correctCount++;
    resultHtml += `<p style="color:#34c759;font-weight:bold;">æ­£è§£ï¼</p>`;
  } else {
    button.classList.add("wrong");
    buttons[quiz.answer].classList.add("correct");
    resultHtml += `<p style="color:#ff3b30;font-weight:bold;">ä¸æ­£è§£</p>`;
  }

  // â˜… è§£èª¬ã‚’è¡¨ç¤º
  resultHtml += `
    <p style="margin-top:10px;">
      <strong>è§£èª¬ï¼š</strong><br>
      ${quiz.explanation}
    </p>
  `;

  document.getElementById("result").innerHTML = resultHtml;
  document.getElementById("nextBtn").style.display = "block";
}


function nextQuestion() {
  currentIndex++;
  if (currentIndex < quizzes[currentLevel].length) {
    showQuestion();
  } else {
  previousScreen = "quiz"; // â† è¿½åŠ 

  document.getElementById("quiz").style.display = "none";
  document.getElementById("resultCard").style.display = "block";
  document.getElementById("scoreText").innerText =
    quizzes[currentLevel].length + "å•ä¸­ " +
    correctCount + "å•æ­£è§£ï¼";
}

}
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function shuffleChoices(quiz) {
  // æ­£è§£ã®é¸æŠè‚¢ã‚’ä¿å­˜
  const correctChoice = quiz.choices[quiz.answer];

  // choices ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  for (let i = quiz.choices.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [quiz.choices[i], quiz.choices[j]] = [quiz.choices[j], quiz.choices[i]];
  }

  // æ­£è§£ãŒã©ã“ã«è¡Œã£ãŸã‹æ¢ã—ã¦ answer ã‚’æ›´æ–°
  quiz.answer = quiz.choices.indexOf(correctChoice);
}

function showResult() {
  // ã‚¯ã‚¤ã‚ºç”»é¢ã‚’éš ã™
  document.getElementById("quiz").style.display = "none";

  const total = quizzes[currentLevel].length;
  const percent = Math.round((correctCount / total) * 100);

  document.getElementById("scoreText").innerHTML = `
    <strong>${total}å•ä¸­ ${correctCount}å•æ­£è§£</strong><br>
    æ­£è§£ç‡ï¼š${percent}%
  `;

  // çµæœã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
  document.getElementById("resultCard").style.display = "block";
}

function restartQuiz() {
  // çµæœã‚«ãƒ¼ãƒ‰ã‚’éš ã™
  document.getElementById("resultCard").style.display = "none";

  // ã‚¯ã‚¤ã‚ºç”»é¢ã‚’éš ã™
  document.getElementById("quiz").style.display = "none";

  // ãƒ¬ãƒ™ãƒ«é¸æŠç”»é¢ã‚’è¡¨ç¤º
  document.getElementById("level").style.display = "block";
}

function retrySameLevel() {
  // çµæœã‚«ãƒ¼ãƒ‰ã‚’éš ã™
  document.getElementById("resultCard").style.display = "none";

  // ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
  currentIndex = 0;
  correctCount = 0;

  // å•é¡Œã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ç›´ã™
  shuffle(quizzes[currentLevel]);

  // ã‚¯ã‚¤ã‚ºç”»é¢ã‚’è¡¨ç¤º
  document.getElementById("quiz").style.display = "block";

  // æœ€åˆã®å•é¡Œã‚’è¡¨ç¤º
  showQuestion();
}
function backToLevel() {
  currentIndex = 0;
  correctCount = 0;

  document.getElementById("quiz").style.display = "none";
  document.getElementById("resultCard").style.display = "none";
  document.getElementById("level").style.display = "block";
}

function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
    showQuestion();
  }
}

/* ===== ã‚¹ãƒ¯ã‚¤ãƒ—æ“ä½œ ===== */
let touchStartX = 0;
let touchEndX = 0;
let touchStartY = 0;

const quizArea = document.getElementById("quiz");

quizArea.addEventListener("touchstart", (e) => {
  touchStartX = e.changedTouches[0].screenX;
  touchStartY = e.changedTouches[0].screenY;
});

quizArea.addEventListener("touchend", (e) => {
  touchEndX = e.changedTouches[0].screenX;
  const diffX = touchEndX - touchStartX;

  // ç”»é¢ç«¯ã‚¹ãƒ¯ã‚¤ãƒ—ã¯ç„¡è¦–ï¼ˆSafariå„ªå…ˆï¼‰
  if (touchStartX < 30 || touchStartX > window.innerWidth - 30) return;

  if (Math.abs(diffX) < 60) return;

  // ğŸ‘‰ å‰ã¸
  if (diffX > 0 && currentIndex > 0) {
    prevQuestion();
  }

  // ğŸ‘ˆ æ¬¡ã¸ï¼ˆè§£ç­”å¾Œã®ã¿ï¼‰
  if (diffX < 0 && document.getElementById("nextBtn").style.display === "block") {
    nextQuestion();
  }
});




</script>

</body>
</html>
